%%

%class ParserHelper;
%namespace frontend ;

%token MODULE PROCEDURE BEGIN END TYPE RECORD VAR COLON ID EQ SEMI COMMA;
%root module;

%%

module :
	MODULE ID SEMI
		decls
		optStmts
	END ID SEMI ~> {handleModule}
;

decls :
	types
	vars
	procdecls ~> {handleDecls}
;

vars :
|	VAR vardecls ~> {handleVars}
;

vardecls :
|	vardecl vardecls ~> {handleAppendVarDecl}
;

identlist :
	ID                  ~> {handleSingleIdent}
|	identlist COMMA ID  ~> {handleAppendIdent}
;

vardecl :
	identlist COLON ID SEMI ~> {handleVarDecl}
; 

types :
|	TYPE typedecls ~> {handleTypes}
;

typedecls :
|	typedecl typedecls  ~> {handleAppendTypeDecl}
;

typedecl : ID EQ typedesc SEMI ~> {handleTypeDecl}
;

typedesc :
	RECORD
	END    ~> {handleRecord}
;

optStmts :
| 	BEGIN
;

procdecls :
	                   ~> {handleEmptyProcDecls}
|	procdecl procdecls ~> {handleAppendProcDecl}
;

procdecl :
	PROCEDURE ID SEMI
		decls
	BEGIN
	END ID SEMI ~> {handleProcedure}
;